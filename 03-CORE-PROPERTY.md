# 03 - ç‰©ä»¶ãƒ»éƒ¨å±‹ç®¡ç†ï¼ˆå…±é€šæ©Ÿèƒ½ï¼‰

## Claude Code Implementation Guide - Core Property Management

> **Note**: ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ `00-MAIN.md` ã®ç‰©ä»¶ç®¡ç†éƒ¨åˆ†ã‚’è©³ç´°åŒ–ã—ãŸã‚‚ã®ã§ã™ã€‚
> ç”»é¢æ§‹æˆãƒ»URL æ§‹é€ ã¯ `00-MAIN.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## âš ï¸ Claude Code ã¸ã®æœ€é‡è¦æŒ‡ç¤º

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ã“ã® `03-CORE-PROPERTY.md` ã‚’èµ·ç‚¹ã«ã€å¤šãã® FEATURES ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ`04-APARTMENT-FEATURES.md`, `05-OFFICE-FEATURES.md`, `06-BILLING.md` ãªã©ï¼‰ãŒè¿½åŠ ã•ã‚Œã¦ã„ãã¾ã™ã€‚

### å®Ÿè£…æ™‚ã®æœ€å„ªå…ˆäº‹é …

**æ©Ÿèƒ½ï¼ˆFEATURESï¼‰ã¯ã€ã‚ã‹ã‚Šã‚„ã™ããƒ»ä¿®æ­£ã—ã‚„ã™ãä½œæˆã™ã‚‹ã“ã¨**

å…·ä½“çš„ã«ã¯ï¼š

1. **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®åˆ†é›¢**

   - å„æ©Ÿèƒ½ã¯ç‹¬ç«‹ã—ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ/ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦å®Ÿè£…
   - æ©Ÿèƒ½ãƒ•ãƒ©ã‚°ã§ ON/OFF ã§ãã‚‹è¨­è¨ˆ
   - ä»–ã®æ©Ÿèƒ½ã«å½±éŸ¿ã‚’ä¸ãˆãªã„

2. **ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã®ä¸€è²«æ€§**

   ```
   components/features/
   â”œâ”€â”€ properties/     # 03-COREï¼ˆå…±é€šï¼‰
   â”œâ”€â”€ units/          # 03-COREï¼ˆå…±é€šï¼‰
   â”œâ”€â”€ tenants/        # 03-COREï¼ˆå…±é€šï¼‰
   â”œâ”€â”€ meter/          # 04-APARTMENT
   â”œâ”€â”€ floor-plan/     # 05-OFFICE
   â”œâ”€â”€ lease-detail/   # 05-OFFICE
   â””â”€â”€ billing/        # 06-BILLING
   ```

3. **å‘½åè¦å‰‡ã®çµ±ä¸€**

   - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ: `{Feature}List`, `{Feature}Form`, `{Feature}Card`, `{Feature}Detail`
   - API: `/api/{feature}`, `/api/{feature}/[id]`
   - å‹: `{Feature}`, `{Feature}Input`, `{Feature}Status`

4. **æ©Ÿèƒ½ãƒ•ãƒ©ã‚°ã®ãƒã‚§ãƒƒã‚¯æ–¹æ³•**

   ```typescript
   // ã™ã¹ã¦ã®æ©Ÿèƒ½ã§çµ±ä¸€ã—ãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨
   const hasMeterReadings = useFeature("meter_readings");

   // æ¡ä»¶ä»˜ããƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
   {
     hasMeterReadings && <MeterSection />;
   }

   // æ¡ä»¶ä»˜ããƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼ˆmiddleware or layoutï¼‰
   ```

5. **ä¿®æ­£ã—ã‚„ã™ã•ã®ç¢ºä¿**
   - 1 ãƒ•ã‚¡ã‚¤ãƒ« = 1 è²¬ä»»ï¼ˆSingle Responsibilityï¼‰
   - ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼/æ–‡å­—åˆ—ã¯å®šæ•°åŒ–
   - å…±é€šãƒ­ã‚¸ãƒƒã‚¯ã¯ hooks/ ã¾ãŸã¯ lib/ ã«æŠ½å‡º

### FEATURES è¿½åŠ æ™‚ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

æ–°ã—ã„æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹éš›ã¯ã€ä»¥ä¸‹ã‚’ç¢ºèªï¼š

- [ ] æ©Ÿèƒ½ãƒ•ãƒ©ã‚°ã§åˆ¶å¾¡ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] ç‹¬ç«‹ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] å‘½åè¦å‰‡ã«å¾“ã£ã¦ã„ã‚‹ã‹
- [ ] å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆButton, Input ç­‰ï¼‰ã‚’å†åˆ©ç”¨ã—ã¦ã„ã‚‹ã‹
- [ ] å‹å®šç¾©ãŒ types/ ã«è¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒ RESTful ã‹

---

## 1. æ¦‚è¦

### 1.1 ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç¯„å›²

| æ©Ÿèƒ½             | èª¬æ˜                                                      |
| ---------------- | --------------------------------------------------------- |
| ç‰©ä»¶ CRUD        | ç‰©ä»¶ã®ç™»éŒ²ãƒ»Ğ·Ğ°ÑĞ°Ñ…ãƒ»å‰Šé™¤ãƒ»ä¸€è¦§                             |
| éƒ¨å±‹ CRUD        | éƒ¨å±‹ã®ç™»éŒ²ãƒ»Ğ·Ğ°ÑĞ°Ñ…ãƒ»å‰Šé™¤ãƒ»ä¸€è¦§ãƒ»ä¸€æ‹¬ç™»éŒ²                   |
| å…¥å±…è€… CRUD      | å…¥å±…è€…ã®ç™»éŒ²ãƒ»Ğ·Ğ°ÑĞ°Ñ…ãƒ»ä¸€è¦§ï¼ˆèªè¨¼éƒ¨åˆ†ã¯ `02-AUTH.md` å‚ç…§ï¼‰ |
| å¥‘ç´„ç®¡ç†ï¼ˆåŸºæœ¬ï¼‰ | å…¥å±…è€…ã¨éƒ¨å±‹ã®ç´ä»˜ã‘ã€é€€å»å‡¦ç†                            |

### 1.2 æ©Ÿèƒ½ãƒ•ãƒ©ã‚°ã«ã‚ˆã‚‹æ‹¡å¼µ

ä»¥ä¸‹ã®æ©Ÿèƒ½ã¯åˆ¥ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§è©³ç´°åŒ–ï¼š

| æ©Ÿèƒ½ãƒ•ãƒ©ã‚°         | å‚ç…§å…ˆ                     |
| ------------------ | -------------------------- |
| `floor_plan`       | `05-OFFICE-FEATURES.md`    |
| `lease_management` | `05-OFFICE-FEATURES.md`    |
| `meter_readings`   | `04-APARTMENT-FEATURES.md` |

---

## 2. ç‰©ä»¶ç®¡ç†

### 2.1 ç‰©ä»¶ä¸€è¦§ç”»é¢

**ãƒ‘ã‚¹**: `/dashboard/properties`

**è¡¨ç¤ºé …ç›®**:
| é …ç›® | èª¬æ˜ |
|------|------|
| ç‰©ä»¶å | ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°ã¸ |
| ç‰©ä»¶ã‚¿ã‚¤ãƒ— | ã‚¢ãƒ‘ãƒ¼ãƒˆ / ĞÑ„Ñ„Ğ¸Ñï¼ˆãƒãƒƒã‚¸è¡¨ç¤ºï¼‰ |
| ä½æ‰€ | çœç•¥è¡¨ç¤ºï¼ˆé•·ã„å ´åˆï¼‰ |
| ĞĞ¸Ğ¹Ñ‚ Ó©Ñ€Ó©Ó© | units ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰é›†è¨ˆ |
| å…¥å±…ç‡ | (occupied / total) Ã— 100% |

**æ©Ÿèƒ½**:

- æ¤œç´¢: ç‰©ä»¶åã€ä½æ‰€ã§çµã‚Šè¾¼ã¿
- è¡¨ç¤º: ã‚«ãƒ¼ãƒ‰å½¢å¼ï¼ˆã‚°ãƒªãƒƒãƒ‰ï¼‰

### 2.2 ç‰©ä»¶ç™»éŒ²ãƒ»Ğ·Ğ°ÑĞ°Ñ… ç”»é¢

**ãƒ‘ã‚¹**: `/dashboard/properties/new`, `/dashboard/properties/[id]/edit`

**ãƒ•ã‚©ãƒ¼ãƒ é …ç›®**:
| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | å¿…é ˆ | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
|-----------|-----|:----:|---------------|
| name | string | âœ… | 1 æ–‡å­—ä»¥ä¸Š |
| property_type | select | âœ… | 'apartment' \| 'office' |
| address | string | âœ… | 1 æ–‡å­—ä»¥ä¸Š |
| description | textarea | - | - |
| total_floors | number | - | 1 ä»¥ä¸Šã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ 1 |

**ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯**:

- æ–°è¦ä½œæˆæ™‚ã€`company_id` ã¯èªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‰€å±ä¼šç¤¾ã‹ã‚‰è‡ªå‹•è¨­å®š
- `property_type` ã¯ç™»éŒ²å¾Œã‚‚å¤‰æ›´å¯èƒ½ï¼ˆãƒ©ãƒ™ãƒ«ã®ã¿ãªã®ã§å½±éŸ¿ãªã—ï¼‰

### 2.3 Ğ‘Ğ°Ñ€Ğ¸Ğ»Ğ³Ñ‹Ğ½ Ğ´ÑĞ»Ğ³ÑÑ€ÑĞ½Ğ³Ò¯Ğ¹ ç”»é¢

**ãƒ‘ã‚¹**: `/dashboard/properties/[id]`

**è¡¨ç¤ºå†…å®¹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ã‚¢ã‚¤ã‚³ãƒ³] [ãƒãƒƒã‚¸:ã‚¢ãƒ‘ãƒ¼ãƒˆ] ç‰©ä»¶å                          â”‚
â”‚ ğŸ“ ä½æ‰€                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚ â”‚ ĞĞ¸Ğ¹Ñ‚ Ó©Ñ€Ó©Ó©  â”‚ â”‚ Ğ­Ğ·ÑĞ¼ÑˆĞ¸Ğ³Ñ‡Ñ‚ÑĞ¹   â”‚ â”‚ Ğ¡ÑƒĞ» Ó©Ñ€Ó©Ó©     â”‚ â”‚ãƒ¡ãƒ³ãƒ†    â”‚        â”‚
â”‚ â”‚    12    â”‚ â”‚    8    â”‚ â”‚    3    â”‚ â”‚    1    â”‚        â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [éƒ¨å±‹ç®¡ç†] [å…¥å±…è€…ä¸€è¦§] [è¨­å®š]                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**çµ±è¨ˆã®è¨ˆç®—**:

- ĞĞ¸Ğ¹Ñ‚ Ó©Ñ€Ó©Ó©: `units` ãƒ†ãƒ¼ãƒ–ãƒ«ã® count
- Ğ­Ğ·ÑĞ¼ÑˆĞ¸Ğ³Ñ‡Ñ‚ÑĞ¹: `units.status = 'occupied'` ã® count
- Ğ¡ÑƒĞ» Ó©Ñ€Ó©Ó©: `units.status = 'vacant'` ã® count
- Ğ—Ğ°ÑĞ²Ğ°Ñ€Ñ‚Ğ°Ğ¹: `units.status = 'maintenance'` ã® count

---

## 3. éƒ¨å±‹ç®¡ç†

### 3.1 Ó¨Ñ€Ó©Ó©Ğ½Ğ¸Ğ¹ Ğ¶Ğ°Ğ³ÑĞ°Ğ°Ğ»Ñ‚ ç”»é¢

**ãƒ‘ã‚¹**: `/dashboard/properties/[id]/units`

**è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰**:

- ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤ºï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰: Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€ ã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã€è‰²ã§ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
- ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤º: ä¸€è¦§å½¢å¼

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è‰²**:
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | è‰² | èª¬æ˜ |
|-----------|-----|------|
| vacant | é’ | Ğ¡ÑƒĞ» Ó©Ñ€Ó©Ó© |
| occupied | ç·‘ | Ğ­Ğ·ÑĞ¼ÑˆĞ¸Ğ³Ñ‡Ñ‚ÑĞ¹ |
| maintenance | é»„ | Ğ—Ğ°ÑĞ²Ğ°Ñ€Ñ‚Ğ°Ğ¹ ä¸­ |
| reserved | ç´« | äºˆç´„æ¸ˆ |

**ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤ºã®ä»•æ§˜**:

```
â”Œâ”€ Ğ¢Ğ°Ğ¹Ğ»Ğ±Ğ°Ñ€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [é’] Ğ¡ÑƒĞ» Ó©Ñ€Ó©Ó©  [ç·‘] Ğ­Ğ·ÑĞ¼ÑˆĞ¸Ğ³Ñ‡Ñ‚ÑĞ¹  [é»„] Ğ—Ğ°ÑĞ²Ğ°Ñ€Ñ‚Ğ°Ğ¹                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€  [301][302][303][304]                                  â”‚
â”‚ 2Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€  [201][202][203][204]                                  â”‚
â”‚ 1Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€  [101][102][103][104]                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- ä¸Šã® Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€ ã‹ã‚‰è¡¨ç¤ºï¼ˆé™é †ï¼‰
- å„ã‚»ãƒ«ã«éƒ¨å±‹ç•ªå·ã€Ğ¢Ğ°Ğ»Ğ±Ğ°Ğ¹ï¼ˆã‚ã‚Œã°ï¼‰ã‚’è¡¨ç¤º
- ã‚¯ãƒªãƒƒã‚¯ã§éƒ¨å±‹è©³ç´°ã¸

### 3.2 éƒ¨å±‹ç™»éŒ²ãƒ»Ğ·Ğ°ÑĞ°Ñ… ç”»é¢

**ãƒ‘ã‚¹**: `/dashboard/properties/[id]/units/new`, `/dashboard/properties/[id]/units/[unitId]/edit`

**ãƒ•ã‚©ãƒ¼ãƒ é …ç›®**:
| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | å¿…é ˆ | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
|-----------|-----|:----:|---------------|
| unit_number | string | âœ… | 1 æ–‡å­—ä»¥ä¸Šã€ç‰©ä»¶å†…ã§ãƒ¦ãƒ‹ãƒ¼ã‚¯ |
| floor | select | - | 1ã€œç· Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€ æ•° |
| area_sqm | number | - | 0 ã‚ˆã‚Šå¤§ãã„ |
| rooms | number | - | 1 ä»¥ä¸Š |
| monthly_rent | number | - | 0 ä»¥ä¸Š |
| status | select | âœ… | 'vacant' \| 'occupied' \| 'maintenance' \| 'reserved' |
| notes | textarea | - | - |

**ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è©³ç´°**:

- `unit_number`: åŒã˜ç‰©ä»¶å†…ã§é‡è¤‡ä¸å¯ï¼ˆDB åˆ¶ç´„: `UNIQUE(property_id, unit_number)`ï¼‰
- æ–°è¦ä½œæˆæ™‚ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ `status`: 'vacant'

### 3.3 éƒ¨å±‹ä¸€æ‹¬ç™»éŒ²ç”»é¢

**ãƒ‘ã‚¹**: `/dashboard/properties/[id]/units/bulk`

**å…¥åŠ›é …ç›®**:
| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|-----------|-----|-----------|------|
| startFloor | number | 1 | é–‹å§‹ Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€ |
| endFloor | number | ç· Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€ æ•° | çµ‚äº† Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€ |
| unitsPerFloor | number | 4 | å„ Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€ ã® Ó¨Ñ€Ó©Ó©Ğ½Ğ¸Ğ¹ Ñ‚Ğ¾Ğ¾ |
| prefix | string | '' | éƒ¨å±‹ç•ªå·ã®æ¥é ­è¾ï¼ˆä¾‹: 'A-'ï¼‰ |

**éƒ¨å±‹ç•ªå·ç”Ÿæˆãƒ«ãƒ¼ãƒ«**:

```
{prefix}{Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€æ•°}{é€£ç•ª(2æ¡ã‚¼ãƒ­åŸ‹ã‚)}

ä¾‹: prefix='', 2Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€, 3ç•ªç›® â†’ '203'
ä¾‹: prefix='A-', 2Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€, 3ç•ªç›® â†’ 'A-203'
```

**ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½**:

- ä½œæˆå‰ã«ç”Ÿæˆã•ã‚Œã‚‹éƒ¨å±‹ç•ªå·ä¸€è¦§ã‚’è¡¨ç¤º
- ç·æ•°ã‚’è¡¨ç¤ºï¼ˆã€Œ12 å®¤ã‚’ä½œæˆã€ãªã©ï¼‰

**ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯**:

- ã™ã¹ã¦ `status: 'vacant'` ã§ä½œæˆ
- æ—¢å­˜ã®éƒ¨å±‹ç•ªå·ã¨é‡è¤‡ã™ã‚‹å ´åˆã¯ã‚¨ãƒ©ãƒ¼

### 3.4 éƒ¨å±‹è©³ç´°ç”»é¢

**ãƒ‘ã‚¹**: `/dashboard/properties/[id]/units/[unitId]`

**è¡¨ç¤ºå†…å®¹**:

- éƒ¨å±‹æƒ…å ±ï¼ˆç•ªå·ã€Ğ”Ğ°Ğ²Ñ…Ğ°Ñ€ã€Ğ¢Ğ°Ğ»Ğ±Ğ°Ğ¹ã€å®¶è³ƒã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰
- ç¾åœ¨ã®å…¥å±…è€…æƒ…å ±ï¼ˆå¥‘ç´„ä¸­ã®å ´åˆï¼‰
- å¥‘ç´„å±¥æ­´

**ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**:

- Ğ·Ğ°ÑĞ°Ñ…
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´
- å…¥å±…è€…å‰²ã‚Šå½“ã¦ï¼ˆĞ¡ÑƒĞ» Ó©Ñ€Ó©Ó© ã®å ´åˆï¼‰
- é€€å»å‡¦ç†ï¼ˆĞ­Ğ·ÑĞ¼ÑˆĞ¸Ğ³Ñ‡Ñ‚ÑĞ¹ ã®å ´åˆï¼‰

### 3.5 éƒ¨å±‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é·ç§»

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚     vacant      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚          â”‚     (Ğ¡ÑƒĞ» Ó©Ñ€Ó©Ó©)      â”‚          â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
         â”‚                   â”‚                   â”‚
         â”‚            å…¥å±…è€…å‰²å½“                  â”‚
         â”‚                   â”‚                   â”‚
         â”‚                   â–¼                   â”‚
    é€€å»å‡¦ç†          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
         â”‚          â”‚                 â”‚         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    occupied     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚    (Ğ­Ğ·ÑĞ¼ÑˆĞ¸Ğ³Ñ‡Ñ‚ÑĞ¹)     â”‚         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
                             â”‚                  â”‚
                      Ğ—Ğ°ÑĞ²Ğ°Ñ€Ñ‚Ğ°Ğ¹é–‹å§‹       Ğ—Ğ°ÑĞ²Ğ°Ñ€Ñ‚Ğ°Ğ¹å®Œäº†
                             â”‚                  â”‚
                             â–¼                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
                    â”‚                 â”‚         â”‚
                    â”‚  maintenance    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ (Ğ—Ğ°ÑĞ²Ğ°Ñ€Ñ‚Ğ°Ğ¹)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. å…¥å±…è€…ç®¡ç†

> **Note**: å…¥å±…è€…ã®èªè¨¼ãƒ»ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆã«ã¤ã„ã¦ã¯ `02-AUTH.md` ã‚’å‚ç…§

### 4.1 å…¥å±…è€…ä¸€è¦§ç”»é¢

**ãƒ‘ã‚¹**: `/dashboard/tenants`

**è¡¨ç¤ºé …ç›®**:
| é …ç›® | èª¬æ˜ |
|------|------|
| åå‰ | ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°ã¸ |
| é›»è©±ç•ªå· | ãƒ­ã‚°ã‚¤ãƒ³ ID ã¨ã—ã¦ä½¿ç”¨ |
| ã‚¿ã‚¤ãƒ— | å€‹äºº / æ³•äººï¼ˆãƒãƒƒã‚¸ï¼‰ |
| ç‰©ä»¶ / éƒ¨å±‹ | ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå¥‘ç´„ã‹ã‚‰å–å¾— |
| å¥‘ç´„çŠ¶æ…‹ | å¥‘ç´„ä¸­ / æœªå¥‘ç´„ï¼ˆãƒãƒƒã‚¸ï¼‰ |

**æ©Ÿèƒ½**:

- æ¤œç´¢: åå‰ã€é›»è©±ç•ªå·ã§çµã‚Šè¾¼ã¿

### 4.2 å…¥å±…è€…ç™»éŒ²ç”»é¢

**ãƒ‘ã‚¹**: `/dashboard/tenants/new`

**ãƒ•ã‚©ãƒ¼ãƒ é …ç›®**:
| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | å¿…é ˆ | æ¡ä»¶ |
|-----------|-----|:----:|------|
| tenant_type | select | âœ… | 'individual' \| 'company' |
| name | string | âœ… | - |
| phone | string | âœ… | ãƒ­ã‚°ã‚¤ãƒ³ ID ã«ãªã‚‹ |
| unitId | select | âœ… | Ğ¡ÑƒĞ» Ó©Ñ€Ó©Ó© ã®ã¿é¸æŠå¯ |
| company_name | string | - | tenant_type='company'ã®å ´åˆã®ã¿è¡¨ç¤º |
| notes | textarea | - | - |

**ç™»éŒ²ãƒ•ãƒ­ãƒ¼ï¼ˆ`02-AUTH.md` å‚ç…§ï¼‰**:

1. ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›
2. åˆæœŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è‡ªå‹•ç”Ÿæˆ
3. Supabase Auth ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆï¼ˆé›»è©±ç•ªå· â†’ å½è£…ãƒ¡ãƒ¼ãƒ«ï¼‰
4. tenants ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¿½åŠ 
5. leases ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¥‘ç´„ä½œæˆ
6. units.status ã‚’ 'occupied' ã«æ›´æ–°
7. åˆæœŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç”»é¢ã«è¡¨ç¤ºï¼ˆç®¡ç†ä¼šç¤¾ãŒå…¥å±…è€…ã«ä¼ãˆã‚‹ï¼‰

### 4.3 å…¥å±…è€…è©³ç´°ç”»é¢

**ãƒ‘ã‚¹**: `/dashboard/tenants/[id]`

**è¡¨ç¤ºå†…å®¹**:

- åŸºæœ¬æƒ…å ±ï¼ˆåå‰ã€é›»è©±ç•ªå·ã€ã‚¿ã‚¤ãƒ—ï¼‰
- æ³•äººæƒ…å ±ï¼ˆæ³•äººã®å ´åˆï¼‰
- ç¾åœ¨ã®å¥‘ç´„æƒ…å ±
- è«‹æ±‚å±¥æ­´ï¼ˆ`06-BILLING.md` å‚ç…§ï¼‰

**ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**:

- Ğ·Ğ°ÑĞ°Ñ…
- é€€å»å‡¦ç†
- åˆæœŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†ç™ºè¡Œï¼ˆå¿…è¦ãªå ´åˆï¼‰

---

## 5. å¥‘ç´„ç®¡ç†ï¼ˆåŸºæœ¬ï¼‰

> **Note**: è©³ç´°å¥‘ç´„ç®¡ç†ï¼ˆ`lease_management` æ©Ÿèƒ½ï¼‰ã¯ `05-OFFICE-FEATURES.md` å‚ç…§

### 5.1 å¥‘ç´„ã®è‡ªå‹•ä½œæˆ

å…¥å±…è€…ç™»éŒ²æ™‚ã«éƒ¨å±‹ã‚’é¸æŠã™ã‚‹ã¨ã€ä»¥ä¸‹ã®å¥‘ç´„ãŒè‡ªå‹•ä½œæˆã•ã‚Œã‚‹ï¼š

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰   | å€¤             |
| ------------ | -------------- |
| unit_id      | é¸æŠã—ãŸéƒ¨å±‹   |
| tenant_id    | ä½œæˆã—ãŸå…¥å±…è€… |
| company_id   | ç®¡ç†ä¼šç¤¾       |
| start_date   | å½“æ—¥           |
| end_date     | nullï¼ˆç„¡æœŸé™ï¼‰ |
| monthly_rent | éƒ¨å±‹ã®æœˆé¡å®¶è³ƒ |
| status       | 'active'       |

### 5.2 é€€å»å‡¦ç†

**ãƒˆãƒªã‚¬ãƒ¼**: å…¥å±…è€…è©³ç´°ç”»é¢ or éƒ¨å±‹è©³ç´°ç”»é¢ã®ã€Œé€€å»å‡¦ç†ã€ãƒœã‚¿ãƒ³

**å‡¦ç†å†…å®¹**:

1. ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
2. `leases.status` ã‚’ 'terminated' ã«æ›´æ–°
3. `leases.end_date` ã‚’å½“æ—¥ã«è¨­å®š
4. `units.status` ã‚’ 'vacant' ã«æ›´æ–°

**æ³¨æ„**: æœªæ‰•ã„è«‹æ±‚ãŒã‚ã‚‹å ´åˆã¯è­¦å‘Šã‚’è¡¨ç¤ºï¼ˆãƒ–ãƒ­ãƒƒã‚¯ã¯ã—ãªã„ï¼‰

### 5.3 å¥‘ç´„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹

| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | èª¬æ˜                        |
| ---------- | --------------------------- |
| active     | å¥‘ç´„ä¸­                      |
| expired    | æœŸé™åˆ‡ã‚Œï¼ˆend_date ãŒéå»ï¼‰ |
| terminated | è§£ç´„æ¸ˆã¿                    |
| pending    | å¥‘ç´„å¾…ã¡ï¼ˆå°†æ¥ã®äºˆç´„ç”¨ï¼‰    |

---

## 6. API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### 6.1 ç‰©ä»¶ API

| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹                   | èª¬æ˜     | å…¥åŠ›          | å‡ºåŠ›       |
| -------- | ---------------------- | -------- | ------------- | ---------- |
| GET      | `/api/properties`      | ä¸€è¦§å–å¾— | -             | Property[] |
| POST     | `/api/properties`      | æ–°è¦ä½œæˆ | PropertyInput | Property   |
| GET      | `/api/properties/[id]` | è©³ç´°å–å¾— | -             | Property   |
| PUT      | `/api/properties/[id]` | æ›´æ–°     | PropertyInput | Property   |
| DELETE   | `/api/properties/[id]` | å‰Šé™¤     | -             | -          |

### 6.2 éƒ¨å±‹ API

| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹                              | èª¬æ˜     | å…¥åŠ›          | å‡ºåŠ›   |
| -------- | --------------------------------- | -------- | ------------- | ------ |
| GET      | `/api/properties/[id]/units`      | ä¸€è¦§å–å¾— | -             | Unit[] |
| POST     | `/api/properties/[id]/units`      | æ–°è¦ä½œæˆ | UnitInput     | Unit   |
| POST     | `/api/properties/[id]/units/bulk` | ä¸€æ‹¬ä½œæˆ | BulkUnitInput | Unit[] |
| GET      | `/api/units/[id]`                 | è©³ç´°å–å¾— | -             | Unit   |
| PUT      | `/api/units/[id]`                 | æ›´æ–°     | UnitInput     | Unit   |
| DELETE   | `/api/units/[id]`                 | å‰Šé™¤     | -             | -      |

### 6.3 å…¥å±…è€… API

| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹                | èª¬æ˜     | å…¥åŠ›        | å‡ºåŠ›                        |
| -------- | ------------------- | -------- | ----------- | --------------------------- |
| GET      | `/api/tenants`      | ä¸€è¦§å–å¾— | -           | Tenant[]                    |
| POST     | `/api/tenants`      | æ–°è¦ä½œæˆ | TenantInput | { tenant, initialPassword } |
| GET      | `/api/tenants/[id]` | è©³ç´°å–å¾— | -           | Tenant                      |
| PUT      | `/api/tenants/[id]` | æ›´æ–°     | TenantInput | Tenant                      |

### 6.4 å¥‘ç´„ API

| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹                         | èª¬æ˜     | å…¥åŠ› | å‡ºåŠ› |
| -------- | ---------------------------- | -------- | ---- | ---- |
| POST     | `/api/leases/[id]/terminate` | é€€å»å‡¦ç† | -    | -    |

---

## 7. å…¥åŠ›å‹å®šç¾©

```typescript
// APIå…¥åŠ›ã®å‹ï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ï¼‰

interface PropertyInput {
  name: string; // required, min 1
  property_type: "apartment" | "office"; // required
  address: string; // required, min 1
  description?: string;
  total_floors?: number; // min 1, default 1
}

interface UnitInput {
  unit_number: string; // required, unique per property
  floor?: number;
  area_sqm?: number; // > 0
  rooms?: number; // >= 1
  monthly_rent?: number; // >= 0
  status?: "vacant" | "occupied" | "maintenance" | "reserved";
  notes?: string;
}

interface BulkUnitInput {
  startFloor: number; // >= 1
  endFloor: number; // >= startFloor
  unitsPerFloor: number; // >= 1
  prefix?: string;
}

interface TenantInput {
  tenant_type: "individual" | "company"; // required
  name: string; // required
  phone: string; // required, unique
  unitId: string; // required, must be vacant
  company_name?: string; // required if tenant_type = 'company'
  notes?: string;
}
```

---

**Document Version**: 2.0  
**Previous**: `02-AUTH.md`  
**Next**: `04-APARTMENT-FEATURES.md`
